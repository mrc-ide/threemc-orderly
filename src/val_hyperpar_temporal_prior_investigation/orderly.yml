script: script.R

artefacts:
  - data: 
      description:
      - Hyperparameters for each proposal model and temporal prior. 
      filenames:
      - artefacts/hyperparameters.csv
  - data: 
      description:
      - Fit stats used to choose best proposal model and temporal prior.
      filenames:
      - artefacts/fit_stats.csv
  - data: 
      description:
      - shell dataset with model estimates for each proposal model and prior.
      filenames:
      - artefacts/out_final.csv.gz
  - data: 
      description:
      - Plot of current & proposal model MMC vs year for AR 1 temporal prior.
      filenames:
      - artefacts/ar1_year_plots.pdf
  - data: 
      description:
      - Plot of current & proposal model MMC vs agegroup for AR 1 temporal prior.
      filenames:
      - artefacts/ar1_agegroups_plots.pdf
  - data: 
      description:
      - Plot of current & proposal model MMC vs year for RW 1 temporal prior.
      filenames:
      - artefacts/rw1_year_plots.pdf
  - data: 
      description:
      - Plot of current & proposal model MMC vs agegroup for RW 1 temporal prior.
      filenames:
      - artefacts/rw1_agegroups_plots.pdf
  - data: 
      description:
      - Plot of current & proposal model MMC vs year for RW 2 temporal prior.
      filenames:
      - artefacts/rw2_year_plots.pdf
  - data: 
      description:
      - Plot of current & proposal model MMC vs agegroup for RW 2 temporal prior.
      filenames:
      - artefacts/rw2_agegroups_plots.pdf
      
  
displayname: |
  - Fit model with incremented MMC variance/covariance hyerparameters, to 
  determine optimal values for each country. 
  
parameters:
  cntry:
    default: ~
  increment: 
    default: 1
  is_paper: 
    default: TRUE

packages:
  - threemc
  - sf
  - data.table
  - dplyr
  - Matrix
  - TMB
  - rlang
  - ggplot2
  - readr
  
sources:
  - source.R

# global_resources:
#   depends/all_surveys.csv: all_surveys.csv

depends:
  # areas file
  - 00a2_areas_join:
      id: latest
      use:
        depends/areas.geojson: artefacts/areas.geojson
  # surveys
  - 00b3_survey_join:
      id: latest(parameter:is_paper == is_paper)
      use: 
        depends/survey_circumcision.csv.gz: artefacts/survey_circumcision.csv.gz
  # suvrey estimates
  - 00b4_survey_indicators:
      id: latest(parameter:is_paper == is_paper)
      use: 
        depends/survey-circumcision-coverage.csv.gz: artefacts/survey-circumcision-coverage.csv.gz
  # all surveys for each country
  - 00b5_all_surveys:
      id: latest(parameter:is_paper == is_paper)
      use: 
        depends/all_surveys.csv: artefacts/all_surveys.csv
  # populations
  - 00c4_pops_aggregate:
      id: latest
      use: 
        depends/population_singleage_aggr.csv.gz: artefacts/population_singleage_aggr.csv.gz
  # highest variance hyperparameters
  - val_highest_var_hyperpars:
      id: latest
      use:
        depends/high_var_hyperpars.csv.gz: artefacts/high_var_hyperpars.csv.gz
